# DDoS Traffic Generator

This program aims to simulate realistic DDoS attack scenarios so that mitigation techniques can be evaluated properly.
It takes up to two pcap files as input (malicious and non-malicious).
These files are then modified based on the startup parameters and the user input throughout the programs execution.
Before actually sending the traffic, the user will be prompted to save the configuration that he made.
This could be loaded on another execution with the "-loadconfig" flag so the user doesn't have to go through
the configuration steps again.
Short list of features (see help output below for full list):
- modify IPv4 addresses
- set reserved bit in IPv4 header
- combine malicious and non-malicious traffic
- define a reproducable packet order and distribution
- define a range and distribution for IPv4 addresses
- send traffic at custom speeds, loop it and/or apply a startupdelay

## DISCLAIMER

You have to set up your test environment in such a way, that traffic sent with this tool will never enter foreign devices (e.g. internet).

## Prerequisites and compilation

You need the following software installed on your computer to COMPILE the generator:
- g++
- make
- [PcapPlusPlus](https://pcapplusplus.github.io/)

You need the following software installed on your computer to RUN the generator:
- tcpreplay
	
You need the following software installed on your computer to COMPILE the receiver:
- g++
- make
- [PcapPlusPlus](https://pcapplusplus.github.io/)
	
In Debian/Ubuntu you can install g++, make and tcpreplay easily by running:
```bash
apt-get install g++ make tcpreplay
```

After installing [PcapPlusPlus](https://pcapplusplus.github.io/), 
you need to adjust the path to the library in the Makefile of this project.
Run **make** in the projects directory to build it.

The generator and the receiver require superuser privileges.

## Usage

After successfully compiling it, you can execute it without any arguments to print this help:
```
Usage: ./generator.run [ARGUMENTS]

MANDATORY arguments (if not using '-loadconfig'): 

	-dstip [IP]
	-dstmac [MAC]
	-interface [NAME OF THE NETWORK INTERFACE]

Argument overview:

	-interface [value]
		Set the network interface through which traffic should be sent.
		
	-srcip [value]
		Set source IP address.
		default: unmodified when using pre-generated pcap-traffic,
		         random when generating new traffic
				 
	-dstip [value]
		Set the destination IP address.
		
	-dstmac [value]
		Set destination mac address.
		
	-startupdelay [value]
		Defines the amount of seconds that the legitimate traffic
		should run before the malicious traffic starts.
		Has to be a number followed by s (seconds) or p (packets).
		Seconds are disabled when using distributions.
		Examples:
			-startupdelay 30s
			-startupdelay 30p
			
	-legpcap [value]
		Defines a custom pcap-file containing legitimate traffic  to be replayed.
		Value must be a path to the file.
		Example:
			-legpcap /home/username/Documents/traffic.pcap
			
	-malpcap [value]
		Defines a custom pcap-file containing malicious traffic to be replayed.
		Value must be a path to the file.
		Default Pcap-File is SYN.pcap in pcap-subfolder.
		Example:
			-malpcap /home/username/Documents/traffic.pcap
			
	-usedistribution [true/false]
		Defines whether the traffic pattern should follow a probability distribution.
		If set to true, you will be asked to provide a ratio and a seed throughout the program.
		The distribution will end as soon as one of the input files reaches their end.
		This argument requires '-legpcap' to be defined.
		Value must be true or false.
		Default is false.
		
	-usetimestamps [true/false]
		Defines whether the packets should be sent with the intervals they were captured with.
		Cannot be used together with 'legmbps' or 'malmbps'.
		If using 'usedistribution', the bernoulli distribution will be disabled automatically.
		Value must be true or false.
		Default is false.
		
	-loadconfig [path to file]
		Load the configuration of a previous run.
		Value must lead to a configuration file generated by this program.
		No other arguments will be required nor accepted.
		
	-legmbps|malmbps [value]
		Set the replay-speed of the specified pcap-file in megabits per second.
		Sum of both values must not exceed the overall link bandwidth.
		Cannot be used together with 'usetimestamps'.
		Will use 'malmbps' for both files when combining traffic with the bernoulli distribution.

	-loop [value]
		Send the traffic for the specified amount of times.
		Examples: 
			0 = loop forever
			1 = send just once
			2 = send twice.
		Default: 0
```

## Example usage

Send the default malicious pcap file (TCP SYN) to 192.168.200.100 with 
next hop being at 12:34:56:78:90:AB through network interface 'eth0'.
This is the most basic configuration. The program will always ask you to 
confirm your configuration.
```bash
./generator.run -dstip 192.168.200.100 -dstmac 12:34:56:78:90:AB -interface eth0
```


Same configuration like in the previous example, but use the file for 
ICMP Echo Request Flooding instead of TCP SYN Flooding this time.
```bash
./generator.run -dstip 192.168.200.100 -dstmac 12:34:56:78:90:AB -interface eth0 -malpcap ./pcap/ICMP.pcap
```


Combine the previous example with a trace of non-malicious real traffic. 
Packets are sent concurrently at topspeed and their order is not determined.
```bash
./generator.run -dstip 192.168.200.100 -dstmac 12:34:56:78:90:AB -interface eth0 -malpcap ./pcap/ICMP.pcap -legpcap ./pcap/Realtrace.pcap
```

Combine malicious and non-malicious traffic, 
make use of distributions (bernoulli for packet distribution, standard for ip distribution) 
and loop it for 100 iterations at a maximum datarate of 75 Megabits per second:
```bash
./generator.run -dstip 192.168.200.100 -dstmac 12:34:56:78:90:AB -interface eth0 -malpcap ./pcap/somebadtraffic.pcap -legpcap ./pcap/somegoodtraffic.pcap -usedistribution true -loop 100 -malmbps 75
```

## Roadmap

- The user input and parameters might be restructured soon. Input made throughout the programs execution will move to the startup parameters.
- More probability distributions will be added.
- Depending on computational resources, the receiver can show less packets received than sent. I'm trying to find a solution to this as this might distort test results.
- A version with a graphical interface is planned.

